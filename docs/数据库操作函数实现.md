# 数据库函数实现

- [ ] 未完成的任务
- [x] 已完成的任务

简单说明：后端需要实现的数据库函数，下面是具体的函数实现，实现后标记`x`意为已完成
**注意：** 
1. **文档**：请在`docs`文件夹下为你的代码创建相应的文档。描述函数功能，以及如何使用。
2. **注释**：请在你的代码中添加适当的注释，以解释你的代码是如何工作的。特别是对于复杂的算法和技巧，应该详细解释其工作原理。
3. **测试**：提交代码前必须进行测试，确保代码没有问题。
4. **错误处理**：确保不抛出异常，对于错误情况，返回`false`或`None`，我简单说明了一些错误处理，可能不全面，你需要根据实际情况进行处理。
5. 万事无绝对，我可能会根据实际情况进行调整，注意查看更新。（如果你已经完成这个函数，我一般会提醒你；如果你还没问题，就需要注意查看更新了）
6. 对其要求有疑惑的地方，可以看设计文档，或者在群里提问

### 用户表
- [ ] 函数传入：用户名
    - 实现功能：`查询`数据库中用户名对应的密码
    - 错误处理：如果用户名不存在，返回`None`
    - 返回值：密码

- [ ] 函数传入：用户名
    - 实现功能：`查询`数据库中是否存在该用户名
    - 返回值：是否存在`bool`类型，存在返回`true`，不存在返回`false`

附加操作的表：注册码表，等级表
- [ ] 函数传入：用户名，密码和注册码
    - 实现功能：`插入`该用户名和密码，等级为注册码对应的等级，注册码使用次数-1，其他信息默认
    - 错误处理：如果注册码不存在，返回`false`，如果注册码使用次数小于等于0，返回`false`，如果用户名已存在，返回`false`
    - 返回值：是否插入成功`bool`类型，成功返回`true`，失败返回`false`

### 访问日志表
- [ ] 函数传入：ip+浏览器请求头
    - 功能实现：
        1. `查询`数据库中是否存在该ip和浏览器请求头
        2. 如果存在，则`更新`登入失败次数+1
        3. 如果不存在，则`插入`该ip和浏览器请求头，登入失败次数为1
    - 返回值：ip+浏览器请求头对应的登入失败次数

- [ ] 函数传入：ip
    - 功能实现：
        1. `查询`数据库中是否存在该ip（请求头为空）
        2. 如果存在，则`更新`登入失败次数+1
        3. 如果不存在，则`插入`该ip，登入失败次数为1
    - 返回值：ip对应的登入失败次数

- [ ] 函数传入：ip+浏览器请求头
    - 功能实现：`更新`ip+浏览器请求头对应的登入失败次数为0，如果不存在则`插入`
    - 返回值：是否更新成功`bool`类型，成功返回`true`，失败返回`false`

- [ ] 函数传入：无
    - 功能实现：清空访问日志表的所有数据
    - 错误处理：如果因为某些原因清空失败，返回`false`
    - 返回值：如果清空成功返回`true`，否则返回`false`

### 密匙表
- [ ] 函数传入：无
    - 功能实现：`查询`数据库中的密匙
    - 返回值：密匙

- [ ] 函数传入：密匙
    - 功能实现：`插入`密匙
    - 返回值：是否插入成功`bool`类型，成功返回`true`，失败返回`false`

- [ ] 函数传入：无
    - 功能实现：`查询`数据库中密匙过期时间，与当前时间比较
    - 返回值：如果密匙过期返回`true`，否则返回`false`


### 等级表
- [ ] 函数传入：等级，最大容量（KB），最大上传文件大小（KB），回收站保存时间（天）
    - 功能实现：`插入`等级和对应的最大容量，最大上传文件大小，回收站保存时间
    - 错误处理：如果等级已存在，返回`false`
    - 返回值：是否插入成功`bool`类型，成功返回`true`，失败返回`false`

### 注册码表
- [ ] 函数传入：注册码
    - 功能实现：`查询`数据库中是否存在该注册码
    - 错误处理：如果使用次数小于0，返回`false`
    - 返回值：是否存在`bool`类型，存在返回`true`，不存在返回`false`

- [ ] 函数传入：注册码 + 注册码对应的等级 + 使用次数
    - 功能实现：`插入`该注册码和对应的等级和使用次数
    - 错误处理：如果注册码已存在，返回`false`，如果等级不存在，返回`false`，如果使用次数小于0，返回`false`
    - 返回值：是否插入成功`bool`类型，成功返回`true`，失败返回`false`
